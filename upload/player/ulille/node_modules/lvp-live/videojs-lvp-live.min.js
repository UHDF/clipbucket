/**
 * videojs-lvp-live
 * @version 0.0.0
 * @copyright 2017 Bastien <bastien.poirier@univ-lille1.fr>
 * @license MIT
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],t):e.videojsLvpLive=t(e.videojs)}(this,function(e){"use strict";e=e&&e.hasOwnProperty("default")?e["default"]:e;!function(){function e(e){this.value=e}function t(t){function n(a,i){try{var o=t[a](i),s=o.value;s instanceof e?Promise.resolve(s.value).then(function(e){n("next",e)},function(e){n("throw",e)}):r(o.done?"return":"normal",o.value)}catch(l){r("throw",l)}}function r(e,t){switch(e){case"return":a.resolve({value:t,done:!0});break;case"throw":a.reject(t);break;default:a.resolve({value:t,done:!1})}(a=a.next)?n(a.key,a.arg):i=null}var a,i;this._invoke=function(e,t){return new Promise(function(r,o){var s={key:e,arg:t,resolve:r,reject:o,next:null};i?i=i.next=s:(a=i=s,n(e,t))})},"function"!=typeof t["return"]&&(this["return"]=undefined)}"function"==typeof Symbol&&Symbol.asyncIterator&&(t.prototype[Symbol.asyncIterator]=function(){return this}),t.prototype.next=function(e){return this._invoke("next",e)},t.prototype["throw"]=function(e){return this._invoke("throw",e)},t.prototype["return"]=function(e){return this._invoke("return",e)}}();var t=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},n=e.registerPlugin||e.plugin,r=function(){function e(n){t(this,e),this.player=n,this.defaults={},this.firstplay=!0}return e.prototype.checkSrc=function(e){0===e.player.readyState()&&(e.player.src(e.player.currentSource()),setTimeout(function(){e.checkSrc(e)},5e3))},e.prototype.mediaplayerEvents=function(){var e=this;this.player.dash.mediaPlayer.lvp="test",this.player.dash.mediaPlayer.on(dashjs.MediaPlayer.events.PLAYBACK_RATE_CHANGED,function(t){0===t.playbackRate&&e.player.pause()}),this.player.dash.mediaPlayer.on(dashjs.MediaPlayer.events.ERROR,function(t){e.player.paused||e.player.pause()}),this.player.dash.mediaPlayer.on(dashjs.MediaPlayer.events.PLAYBACK_ENDED,function(){e.end(e)})},e.prototype.onPlayerReady=function(e){this.player.addClass("vjs-lvp-live");var t=this.player.currentSource(),n=t.type,r=!1;n!==undefined?r=null!==n.match(/application\/(dash\+xml|x-mpegURL)/):t.src!==undefined&&(r=null!==t.src.match(/(mpd|m3u8)$/));var a=this;r&&(this.mediaplayerEvents(),this.player.controlBar.progressControl.addClass("vjs-hidden"),this.player.controlBar.remainingTimeDisplay.addClass("vjs-hidden"),a.player.controlBar.liveDisplay.removeClass("vjs-hidden"),this.player.on("firstplay",function(e){a.firstplay=!1,setTimeout(function(){a.checkSrc(a)},5e3)}),this.player.on("loadedmetadata",function(e){r&&a.player.controlBar.liveDisplay.removeClass("vjs-hidden"),a.firstplay||(a.mediaplayerEvents(),a.player.pause(),a.player.play())}))},e}(),a=function(t){var n=this;this.ready(function(){var a=new r(n);a.onPlayerReady(e.mergeOptions(a.defaults,t))})};return n("lvpLive",a),a.VERSION="0.0.0",a});