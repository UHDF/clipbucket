/**
 * videojs-lvp-quality
 * @version 0.0.0
 * @copyright 2017 Bastien <bastien.poirier@univ-lille1.fr>
 * @license MIT
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],t):e.videojsLvpQuality=t(e.videojs)}(this,function(e){"use strict";var t=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},n=(e="default"in e?e["default"]:e).registerPlugin||e.plugin,s=function(){function e(n){t(this,e),this.player=n,this.sources={},this.rates=[],this.container=undefined,this.qList=undefined,this.sList=undefined,this.defaults={}}return e.prototype.addEvent=function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n)},e.prototype.onToggleList=function(e){var t=e===this.qList?e:e.currentTarget.parentNode.querySelector(".vjs-lvp-dropdown");-1==t.className.indexOf("show")?t.className+=" show":t.className=t.className.replace(" show","")},e.prototype.onChangeQuality=function(e){var t=this,n=e;if(n){var s=this.player.currentTime(),i=this.player.paused();this.player.src({src:n.src,type:n.type}),this.player.on("loadedmetadata",function(){t.player.currentTime(s),i?(t.player.play(),t.player.pause()):t.player.play()})}this.onToggleList(this.qList)},e.prototype.configSrc=function(e){var t=this;this.qList=document.createElement("div"),this.qList.className="vjs-lvp-dropdown";var n=document.createElement("button");n.setAttribute("type","button"),n.className="vjs-lvp-btn vjs-lvpq",n.onclick=function(e){return t.onToggleList(e)},n.innerHTML=e.textQuality||'<span class="vjs-icon-cog"></span>';var s=document.createElement("ul");if(e.sources)if(this.sources=e.sources,1!==this.sources.length){e.sources.map(function(n,i){var a=document.createElement("li"),r=document.createElement("a");r.innerText=n.name,r.setAttribute("href","#"),t.addEvent(r,"click",function(e){e.preventDefault();for(var s=t.qList.querySelectorAll("li"),i=0;i<s.length;i++)s[i].className="";e.currentTarget.parentElement.className="vjs-lvp-selected",t.onChangeQuality(n)});var o=!1;e["default"]||i+1!==e.sources.length?e["default"]===n.name&&(o=!0):o=!0,o&&(a.className="vjs-lvp-selected",t.player.src({src:n.src,type:n.type})),a.appendChild(r),s.appendChild(a)}),this.qList.appendChild(s),this.container.appendChild(this.qList),this.container.appendChild(n);var i=this;this.addEvent(document,"click",function(e){for(var t=e.target,n=!1;!n&&null!==t.parentNode&&t.parentNode!==document.documentElement;)t==i.container&&(n=!0),t=t.parentNode;n||-1===i.qList.className.indexOf("show")||i.onToggleList(i.qList)})}else this.player.src({src:this.sources[0].src,type:this.sources[0].type})},e.prototype.onPlayerReady=function(e){this.container=document.createElement("div"),this.container.className="vjs-lvp-container",this.configSrc(e),this.player.controlBar.el().insertBefore(this.container,this.player.controlBar.fullscreenToggle.el()),this.player.addClass("vjs-lvp-quality")},e}(),i=function(t){var n=this;this.ready(function(){var i=new s(n);i.onPlayerReady(e.mergeOptions(i.defaults,t))})};return n("lvpQuality",i),i.VERSION="0.0.0",i});