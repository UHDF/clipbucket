<script type="text/javascript">{literal}
$(function(){	
	$.ajax({
		url: '../plugins/updatelang/requests.php',
		method: 'POST',
		data: {action: 'check'}
	}).done(function(msg){
		var plg = $.parseJSON(msg);
		$.each(plg, function(i, p){
			var htmlcontent = '<li><a class="updatelang" data-plg="'+ p +'" href="#">Update lang</a></li>';
			htmlcontent += '<li role="separator" class="divider"></li>';
			$('table ul.dropdown-menu li a[href$="&f='+ p +'"]').closest('ul').prepend(htmlcontent);
		});
	});
	
	$('table ul.dropdown-menu').on('click', 'li a.updatelang', function(e){
		e.preventDefault();
		
		$.ajax({
		url: '../plugins/updatelang/requests.php',
		method: 'POST',
		data: {action: 'update', 'plg': $(this).attr('data-plg')}
		}).done(function(msg){
			var btn = '<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>';
			if(msg !== ''){
				if(/^Error/.test(msg)){
					$('.page-content').prepend('<div class="alert alert-danger alert-dismissible" role="alert">' + btn + msg +'</div>');
				} else {
					$('.page-content').prepend('<div class="alert alert-success alert-dismissible" role="alert">' + btn + msg +'</div>');
				}
			}
		});
	});
});
{/literal}</script>
