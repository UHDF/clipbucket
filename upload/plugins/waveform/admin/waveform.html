<h2>WaveForm</h2>

{if $waveform neq ''}
<div id="pointer_div" onclick="point_it(event)" style="width:100%">
<img src="{$waveform}" title="Forme d'onde de la video" alt="Forme d'onde de la video" width="100%" id="waveform">
</div>
<div id="temps"></div>
{/if}


{literal}
<script language="JavaScript">
	function point_it(event){
	
		var video = document.getElementById("cb_video_js_html5_api");
		var duration = {/literal}{$duration}{literal}

		// Image Width
		var img = document.getElementById('waveform'); 
		var width = img.clientWidth;
		
		// Click position
		pos_x = event.offsetX?(event.offsetX):event.pageX-document.getElementById("pointer_div").offsetLeft;
		
		var debut = Calcul(pos_x, duration, width);

		video.play();
		video.currentTime = debut;
	}
	
	
	function Calcul(pixelEnCours, dureeTotal, pixelTotal){
		
		var debut = Math.ceil(parseFloat((pixelEnCours*dureeTotal)/pixelTotal));

		return debut;
	}
	
	
	
	
	$(document).ready(function(){
		$("#waveform").bind("mousemove",function(e){
		
			var duration = {/literal}{$duration}{literal}

			// Image Width
			var img = document.getElementById('waveform'); 
			var width = img.clientWidth;

		
			var offset = $("#waveform").offset();
			var clickX=e.clientX - offset.left;
			var clickY=e.clientY - offset.top;
			
			var debut = Calcul(clickX, duration, width);
			
			hms = secondsToTime(debut);
			
			if (hms.h < 10){hms.h = "0"+hms.h;}
			if (hms.m < 10){hms.m = "0"+hms.m;}
			if (hms.s < 10){hms.s = "0"+hms.s;}
			
			
			document.getElementById("temps").innerHTML = hms.h + ':' + hms.m + ':' + hms.s;
		});
	});
	
	
	
	
    /**
     * Convert number of seconds into time object
     *
     * @param integer secs Number of seconds to convert
     * @return object
     */
    function secondsToTime(secs)
    {
        var hours = Math.floor(secs / (60 * 60));
       
        var divisor_for_minutes = secs % (60 * 60);
        var minutes = Math.floor(divisor_for_minutes / 60);
     
        var divisor_for_seconds = divisor_for_minutes % 60;
        var seconds = Math.ceil(divisor_for_seconds);
       
        var obj = {
            "h": hours,
            "m": minutes,
            "s": seconds
        };
        return obj;
    }

	
</script>




{/literal}
